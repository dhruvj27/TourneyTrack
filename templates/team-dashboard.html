<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Team Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-800">
  <nav class="bg-gray-800 text-white px-6 py-3 flex items-center justify-between">
    <div class="flex items-center gap-3">
      <a href="index.html" class="text-sm hover:underline">← Home</a>
      <h1 class="text-lg font-semibold">Team Dashboard</h1>
    </div>
    <button id="logout" class="text-sm bg-white/10 px-3 py-1 rounded hover:bg-white/20">Logout</button>
  </nav>

  <main class="max-w-3xl mx-auto px-6 py-8">
    <h2 id="team-title" class="text-2xl font-bold mb-4"></h2>

    <section class="bg-white rounded-lg shadow p-4">
      <h3 class="font-semibold mb-3">Players</h3>
      <div id="players" class="space-y-3"></div>
      <button id="add" class="mt-4 px-3 py-2 rounded bg-gray-200 hover:bg-gray-300">➕ Add Player</button>
      <button id="save" class="mt-4 px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700">Save Changes</button>
      <p id="ok" class="text-green-700 mt-3 hidden">Saved!</p>
    </section>
  </main>

  <script src="../static/data.js"></script>
  <script>
    const user = getCurrentUser();
    if (!user || user.role!=='team') location.href='login-team.html';

    const team = getTeamById(user.teamId);
    document.getElementById('team-title').textContent = `${team.name}`;

    const playersDiv = document.getElementById('players');

   function row(p) {
  const wrap = document.createElement('div');
  wrap.className = 'grid grid-cols-2 md:grid-cols-4 gap-2';
  wrap.innerHTML = `
    <input class="border rounded p-2" placeholder="Player name" value="${p?.name||''}">
    <input class="border rounded p-2" placeholder="Department" value="${p?.department||''}">
    <input class="border rounded p-2" placeholder="Year" value="${p?.year||''}">
    <input class="border rounded p-2" placeholder="Contact" value="${p?.contact||''}">
  `;
  return wrap;
}

    function render() {
      playersDiv.innerHTML = '';
      (team.players || []).forEach(p => playersDiv.appendChild(row(p)));
      if ((team.players||[]).length===0) playersDiv.appendChild(row({}));
    }
    render();

    document.getElementById('add').onclick = () => playersDiv.appendChild(row({}));

    document.getElementById('save').onclick = () => {
  const rows = [...playersDiv.querySelectorAll('.grid')];
  team.players = rows.map(r => {
    const [n,d,y,c] = r.querySelectorAll('input');
    return { name:n.value.trim(), department:d.value.trim(), year:y.value.trim(), contact:c.value.trim() };
  }).filter(x=>x.name);
  saveTeam(team);
  document.getElementById('ok').classList.remove('hidden');
  setTimeout(()=>document.getElementById('ok').classList.add('hidden'), 1500);
};

    document.getElementById('logout').onclick = () => { logout(); location.href='index.html'; };
  </script>
</body>
</html>
