<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Register Existing Team</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-800">

  <!-- Navbar -->
  <nav class="bg-gray-800 text-white px-6 py-3 flex justify-between items-center">
    <a href="javascript:history.back()" class="text-sm hover:underline">← Back</a>
    <h1 class="text-lg font-semibold">Register Existing Team</h1>
  </nav>

  <main class="max-w-3xl mx-auto px-6 py-10">
    <h2 id="tournament-name" class="text-2xl font-bold mb-6"></h2>

    <!-- Success Message -->
    <div id="success-message" class="hidden mb-6 p-4 bg-green-100 text-green-700 rounded-lg">
      ✅ Team registered successfully!
    </div>

    <!-- Already Registered Teams -->
    <section class="mb-10">
      <h3 class="text-xl font-semibold mb-4">Already Registered Teams</h3>
      <div id="registered-teams" class="space-y-4"></div>
    </section>

    <!-- Available Teams -->
    <section>
      <h3 class="text-xl font-semibold mb-4">Available Teams</h3>
      <div id="available-teams" class="space-y-4"></div>
    </section>
  </main>

  <script>
    const params = new URLSearchParams(window.location.search);
    const tournamentName = params.get("name") || "Tournament";
    document.getElementById("tournament-name").textContent = "Tournament: " + tournamentName;

    // Load master teams
    const masterTeams = JSON.parse(localStorage.getItem("teams")) || [];

    // Load registrations
    let registrations = JSON.parse(localStorage.getItem("registrations")) || {};
    if (!registrations[tournamentName]) {
      registrations[tournamentName] = [];
    }

    const registeredTeamsContainer = document.getElementById("registered-teams");
    const availableTeamsContainer = document.getElementById("available-teams");
    const successMessage = document.getElementById("success-message");

    function renderTeams() {
      // Registered teams
      registeredTeamsContainer.innerHTML = "";
      registrations[tournamentName].forEach(teamId => {
        const team = masterTeams.find(t => t.id === teamId);
        if (team) {
          const div = document.createElement("div");
          div.className = "bg-green-100 p-4 rounded-lg shadow";
          div.innerHTML = `<strong>${team.name}</strong> `;
          registeredTeamsContainer.appendChild(div);
        }
      });

      // Available teams
      availableTeamsContainer.innerHTML = "";
      masterTeams
        .filter(t => !registrations[tournamentName].includes(t.id))
        .forEach(team => {
          const div = document.createElement("div");
          div.className = "bg-white p-4 rounded-lg shadow flex justify-between items-center";
          div.innerHTML = `
            <div>
              <strong>${team.name}</strong> 
            </div>
            <button class="bg-blue-600 text-white px-3 py-1 rounded-lg hover:bg-blue-700">
              Register
            </button>
          `;
          div.querySelector("button").addEventListener("click", () => {
            registrations[tournamentName].push(team.id);
            localStorage.setItem("registrations", JSON.stringify(registrations));
            successMessage.classList.remove("hidden");
            renderTeams();
          });
          availableTeamsContainer.appendChild(div);
        });
    }

    renderTeams();
  </script>
</body>
</html>
