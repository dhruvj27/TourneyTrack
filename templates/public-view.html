<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>
    Public Fixtures & Results
    {% if tournament and tournament.name %} • {{ tournament.name }}{% endif %}
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-900">
  <!-- Navbar -->
  <nav class="bg-black text-white">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <a href="{{ url_for('index') }}" class="font-semibold">🏆 TourneyTrackers</a>
      <div class="flex items-center gap-2">
        <a href="{{ url_for('team_login') }}" class="bg-white/10 px-3 py-1 rounded hover:bg-white/20 text-sm">
          Team Login
        </a>
        <a href="{{ url_for('smc_login') }}" class="bg-white/10 px-3 py-1 rounded hover:bg-white/20 text-sm">
          SMC Login
        </a>
      </div>
    </div>
  </nav>

  <main class="max-w-6xl mx-auto px-4 py-6 space-y-6">
    <!-- Tournament Header -->
    <section class="text-center">
      <h1 class="text-3xl font-bold">
        {% if tournament and tournament.name %}
          {{ tournament.name }}
        {% else %}
          Tournament Fixtures & Results
        {% endif %}
      </h1>
      {% if tournament and tournament.start_date and tournament.end_date %}
        <p class="text-gray-600 mt-1">
          {{ tournament.start_date.strftime('%b %d, %Y') }} – {{ tournament.end_date.strftime('%b %d, %Y') }}
        </p>
      {% endif %}
    </section>

    <!-- Upcoming Fixtures -->
   <!-- Upcoming Fixtures -->
<section class="bg-white border rounded-lg shadow-sm">
  <div class="px-5 py-4 border-b">
    <h2 class="text-lg font-semibold">Upcoming Fixtures</h2>
    <p class="text-sm text-gray-600">Matches scheduled today and later.</p>
  </div>

  <div class="p-5">
    {% if upcoming_matches %}
      {% for day, items in upcoming_matches|groupby('date') %}
        <div class="mb-5">
          <h3 class="text-sm font-semibold text-gray-700 mb-2">
            {{ day.strftime('%A, %b %d, %Y') }}
          </h3>

          <div class="grid gap-3">
            {% for m in items %}
              {% set team1_name = (m.team1.name if m.team1 and m.team1.name else m.team1_id) %}
              {% set team2_name = (m.team2.name if m.team2 and m.team2.name else m.team2_id) %}

              <article class="border rounded-lg bg-white shadow-sm">
                <!-- top row: teams -->
                <div class="p-4">
                  <div class="flex items-center justify-between">
                    <div class="flex-1 text-base font-semibold text-gray-900 truncate">{{ team1_name }}</div>
                    <div class="px-3 text-sm text-gray-500">vs</div>
                    <div class="flex-1 text-right text-base font-semibold text-gray-900 truncate">{{ team2_name }}</div>
                  </div>

                  <!-- meta row: time + venue + status -->
                  <div class="mt-2 flex flex-wrap items-center gap-x-4 gap-y-1 text-sm text-gray-600">
                    <span class="inline-flex items-center gap-1">
                      🕒 {{ m.time.strftime('%H:%M') }}
                    </span>
                    <span class="inline-flex items-center gap-1">
                      📍 {{ m.venue }}
                    </span>
                    <span class="inline-flex items-center gap-1 text-xs px-2 py-1 rounded bg-yellow-100 text-yellow-800">
                      scheduled
                    </span>
                  </div>
                </div>
              </article>
            {% endfor %}
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p class="text-sm text-gray-500">No upcoming matches.</p>
    {% endif %}
  </div>
</section>


    <!-- Latest Results (last 10) -->
  <!-- Latest Results (last 10) -->
<section class="bg-white border rounded-lg shadow-sm">
  <div class="px-5 py-4 border-b">
    <h2 class="text-lg font-semibold">Latest Results</h2>
    <p class="text-sm text-gray-600">Showing the most recent 10 completed matches.</p>
  </div>

  <div class="p-5">
    {% if completed_matches %}
      <div class="grid gap-4">
        {% for m in completed_matches %}
          {% set team1_name = (m.team1.name if m.team1 and m.team1.name else m.team1_id) %}
          {% set team2_name = (m.team2.name if m.team2 and m.team2.name else m.team2_id) %}
          {% set team1_won = m.winner_id and m.team1 and (m.team1.team_id == m.winner_id) %}
          {% set team2_won = m.winner_id and m.team2 and (m.team2.team_id == m.winner_id) %}

          <article class="border rounded-lg bg-white shadow-sm">
            <div class="px-4 py-3 border-b text-sm text-gray-600">
              {{ m.date.strftime('%b %d, %Y') }} • {{ m.time.strftime('%H:%M') }} • {{ m.venue }}
            </div>

            <div class="p-4">
              <div class="flex items-center justify-between">
                <div class="flex-1">
                  <div class="text-base font-semibold
                              {% if team1_won %}text-emerald-700{% else %}text-gray-900{% endif %}">
                    {{ team1_name }}
                  </div>
                </div>

                <div class="px-3 text-sm text-gray-500">vs</div>

                <div class="flex-1 text-right">
                  <div class="text-base font-semibold
                              {% if team2_won %}text-emerald-700{% else %}text-gray-900{% endif %}">
                    {{ team2_name }}
                  </div>
                </div>
              </div>

              {# Optional score line if your model stores scores #}
              {% if m.team1_score is defined and m.team2_score is defined %}
                <div class="mt-1 text-center text-lg font-bold">
                  {{ m.team1_score }} — {{ m.team2_score }}
                </div>
              {% endif %}

              <div class="mt-3">
                {% if m.winner_id %}
                  <span class="inline-flex items-center gap-1 text-xs px-2 py-1 rounded
                               bg-emerald-50 text-emerald-700 border border-emerald-200">
                    🏆 Winner:
                    {% if team1_won %}{{ team1_name }}
                    {% elif team2_won %}{{ team2_name }}
                    {% else %}{{ m.winner_id }}{% endif %}
                  </span>
                {% else %}
                  <span class="inline-flex items-center gap-1 text-xs px-2 py-1 rounded
                               bg-gray-100 text-gray-700 border border-gray-200">
                    🤝 Draw
                  </span>
                {% endif %}
              </div>
            </div>
          </article>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-sm text-gray-500">No completed matches yet.</p>
    {% endif %}
  </div>
</section>

  </main>
</body>
</html>
